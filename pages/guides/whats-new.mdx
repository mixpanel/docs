---
title: "What's New"
description: "Auto-updating highlights from Mixpanel Changelogs"
---

import { useEffect, useMemo, useState } from 'react'

export default function WhatsNewPage() {
  // ---- Config ----
  const REPO_LIST_URL =
    'https://api.github.com/repos/mixpanel/docs/contents/pages/changelogs?ref=main'
  const DEFAULT_LIMIT = 10
  const FETCH_COUNT = 30

  // ---- Utilities (scoped inside the component for MDX compatibility) ----
  const parseDateFromName = (name) => {
    const m = name.match(/^(\d{4}-\d{2}-\d{2})-/)
    return m ? m[1] : null
  }

  const parseFrontmatter = (md) => {
    const m = md.match(/^---\n([\s\S]*?)\n---/)
    if (!m) return {}
    const out = {}
    let key = null
    for (const lineRaw of m[1].split('\n')) {
      const line = lineRaw.trim()
      if (!line) continue
      const kv = line.match(/^([A-Za-z0-9_-]+):\s*(.*)$/)
      if (kv) {
        key = kv[1]
        let val = kv[2]
        if (
          (val.startsWith('"') && val.endsWith('"')) ||
          (val.startsWith("'") && val.endsWith("'"))
        ) {
          val = val.slice(1, -1)
        }
        out[key] = val
      } else if (key && line.startsWith('- ')) {
        if (!Array.isArray(out[key])) out[key] = []
        out[key].push(line.slice(2).trim())
      }
    }
    return out
  }

  const extractFirstParagraph = (md) => {
    const stripped = md.replace(/^---[\s\S]*?---/, '').trim()
    const lines = stripped
      .split('\n')
      .filter(Boolean)
      .filter((l) => !l.startsWith('import ') && !l.startsWith('export '))
    return lines.slice(0, 4).join(' ')
  }

  const humanizeSlug = (name) => {
    const noExt = name.replace(/\.mdx$/, '')
    const noDate = noExt.replace(/^\d{4}-\d{2}-\d{2}-/, '')
    return noDate.replace(/-/g, ' ').replace(/\b\w/g, (m) => m.toUpperCase())
  }

  const isNew = (dateStr) => {
    const d = new Date(dateStr)
    if (isNaN(d)) return false
    const days = (Date.now() - d.getTime()) / (1000 * 60 * 60 * 24)
    return days <= 14
  }

  const fmtDate = (dateStr) => {
    const d = new Date(dateStr)
    if (isNaN(d)) return dateStr || ''
    return d.toLocaleDateString(undefined, {
      year: 'numeric',
      month: 'short',
      day: 'numeric'
    })
  }

  const month
